<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Game - Select Mode</title>
<style>
  body {
    background: url('mainbackground.png') no-repeat center center fixed;
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    background-attachment: fixed;
    background-color: black;
    color: #e0e0e0;
    font-family: 'Courier New', monospace;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    text-align: center;
    margin: 0;
    opacity: 0;
    transition: opacity 1s ease;
  }

  body.fade-in {
    opacity: 1;
  }

  h1 {
    font-size: 2em;
    letter-spacing: 2px;
    color: #ffffff;
    margin-bottom: 0.3em;
  }

  h2 {
    font-size: 1.1em;
    color: #000000;
    margin-bottom: 2em;
    letter-spacing: 1px;
    text-shadow: 0 0 6px rgba(0, 0, 0, 0.8);
  }

  .mode-btn {
    background: transparent;
    color: #ffffff;
    text-shadow: 0 0 6px rgba(0, 0, 0, 0.8);
    font-weight: bold;
    border: 1px solid #000000;
    font-family: inherit;
    font-size: 1em;
    padding: 10px 40px;
    margin: 10px 0;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
    width: 230px;
  }

  .mode-btn:hover {
    background-color: #FFFFFF;
    color: #0c0c0c;
    transform: scale(1.03);
  }

  .fade-out {
    animation: fadeOut 1s forwards;
  }

  @keyframes fadeOut {
    from { opacity: 1; }
    to { opacity: 0; }
  }

  footer {
    position: absolute;
    bottom: 10px;
    font-size: 0.8em;
    color: #ffffea;
  }

  /* Tap-to-start overlay */
  #introOverlay {
    position: fixed;
    inset: 0;
    background-color: black;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10;
    opacity: 1;
    transition: opacity 1s ease;
  }

  #introOverlay.fade-out {
    opacity: 0;
    pointer-events: none;
  }

  #introText {
    color: white;
    font-size: 1.5em;
    letter-spacing: 2px;
    font-family: 'Courier New', monospace;
    text-align: center;
    text-shadow: 0 0 10px #ffffff;
    animation: pulse 1.5s infinite;
    cursor: pointer;
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.6; }
  }
</style>
</head>
<body>

  <!-- Tap to Begin Overlay -->
  <div id="introOverlay">
    <div id="introText">tap to display menu...</div>
  </div>

  <h1>The Choice Room</h1>
  <h2>Select Mode</h2>

  <div id="menu">
    <button class="mode-btn" onclick="startMode('The Chamber')">The Chamber</button>
    <button class="mode-btn" onclick="startMode('Awaken')">Awaken</button>
    <button class="mode-btn" onclick="startMode('Mirror Trial')">Mirror Trial</button>
    <button class="mode-btn" onclick="startMode('Memory Loop')">Memory Loop</button>
    <button class="mode-btn" onclick="startMode('Truth Code')">Truth Code</button>
    <button class="mode-btn" onclick="startMode('Soul Trade')">Soul Trade</button>
    <button class="mode-btn" onclick="startMode('The Exit')">The Exit</button>
  </div>

  <footer>© 2025 The Choice Room. All rights reserved.</footer>

  <audio id="bgMusic" src="bgm.mp3" loop></audio>

<script>
const bgMusic = document.getElementById("bgMusic");
const introOverlay = document.getElementById("introOverlay");

window.addEventListener("pageshow", () => {
  document.body.classList.add("fade-in");
});

// When user taps to begin
introOverlay.addEventListener("click", () => {
  // Fade out overlay
  introOverlay.classList.add("fade-out");

  // Start music
  bgMusic.volume = 0;
  bgMusic.play().then(() => {
    // Smooth fade in volume
    let vol = 0;
    const fade = setInterval(() => {
      vol += 0.05;
      if (vol > 1) vol = 1; // ✅ prevents the IndexSizeError
      bgMusic.volume = vol;
      if (vol >= 1) clearInterval(fade);
    }, 100);
  }).catch(err => console.log("Autoplay blocked:", err));

  // Remove overlay completely after fade
  setTimeout(() => {
    introOverlay.style.display = "none";
  }, 1000);
});

function startMode(modeName) {
  document.body.classList.remove("fade-in");
  document.body.classList.add("fade-out");

  setTimeout(() => {
    if (modeName === "The Chamber") {
      window.location.href = "chamber.html";
    } else if (modeName === "Awaken") {
      window.location.href = "awakenIntro.html";
    } else {
      alert(modeName + " is not available yet.");
    }
  }, 800);
}
</script>

</body>
</html>